<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.food.project.mapper.PostMapper">

	<!-- 게시글 리스트 불러오기 -->
	<select id="getPostList" resultType="com.food.project.domain.PostVO">

		select post_code,to_char(post_regdate,'yyyy/mm/dd')as post_regdate, to_char(post_moddate,'yyyy/mm/dd')as post_moddate ,post_content,post_title,post_visit,post_url,post_class from post order by post_regdate
	</select>
	
	<!-- 게시글 불러오기 -->
	<select id="getPost" resultType="com.food.project.domain.PostVO">
		select * from post where post_code=#{post_code}
	</select>
	
	<!-- 게시글 등록하기 -->
	<insert id="insertPost" parameterType="com.food.project.domain.PostVO">
		insert into post(post_code,post_content,post_title,post_visit,post_url,post_class)
		values (concat(to_char(sysdate,'yymmdd'),to_char(post_sequence.NEXTVAL,'FM00000')),#{post_content},#{post_title},#{post_visit},#{post_url},#{post_class})
	</insert>
	
	<!-- 게시글 수정하기 -->
	<update id="updatePost" parameterType="com.food.project.domain.PostVO">
		update post
		set post_moddate = sysdate, post_content = #{post_content},
		post_title=#{post_title}, post_url=#{post_url}
		where post_code=#{post_code}
	</update>

	<!-- 게시글 삭제하기 -->	
	<delete id="deletePost" >
		delete from post where post_code=#{post_code}
	</delete>
	
	
	<!-- 댓글 등록하기 -->
	<select id="getReply" resultType="com.food.project.domain.ReplyVO">
		select * from post_reply where post_code=#{post_code} order by reply_num
	</select>
	
	<!-- 댓글 가져오기 -->	
	<insert id="insertReply" parameterType="com.food.project.domain.ReplyVO">
		insert into post_reply(post_code,reply_regdate,reply_content,reply_num)
		values(#{post_code},#{reply_regdate},#{reply_content},reply_seq.NEXTVAL)
	</insert>
</mapper>